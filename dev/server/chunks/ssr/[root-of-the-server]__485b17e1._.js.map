{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/phuonghuupham/Documents/GitHub/Pathfinity/src/db/schema.ts"],"sourcesContent":["import { boolean, pgTable, text,  timestamp } from \"drizzle-orm/pg-core\";\n\nexport const user = pgTable(\"users\", {\n  id: text(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  email: text(\"email\").notNull().unique(), \n  emailVerified: boolean(\"email_verified\"),\n  image: text(\"image\"),\n  password: text(\"password\"), // Add password field for email authentication\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\nexport const session = pgTable(\"sessions\", {\n  id: text(\"id\").primaryKey(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  token: text(\"token\").notNull().unique(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n  ipAddress: text(\"ip_address\"),\n  userAgent: text(\"user_agent\"),\n  userId: text(\"user_id\").notNull().references(() => user.id, { onDelete: \"cascade\" }),\n});\n\nexport const account = pgTable(\"accounts\", {\n  id: text(\"id\").primaryKey(),\n  userId: text(\"user_id\").notNull().references(() => user.id, { onDelete: \"cascade\" }),\n  accountId: text(\"account_id\").notNull(),\n  providerId: text(\"provider_id\").notNull(),\n  accessToken: text(\"access_token\"),\n  refreshToken: text(\"refresh_token\"),\n  accessTokenExpiresAt: timestamp(\"access_token_expires_at\"),\n  refreshTokenExpiresAt: timestamp(\"refresh_token_expires_at\"),\n  scope: text(\"scope\"),\n  idToken: text(\"id_token\"),\n  password: text(\"password\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\nexport const verification = pgTable(\"verifications\", {\n  id: text(\"id\").primaryKey(),\n  identifier: text(\"identifier\").notNull(),\n  value: text(\"value\").notNull(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").notNull(),\n});"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;;AAEO,MAAM,OAAO,IAAA,gKAAO,EAAC,SAAS;IACnC,IAAI,IAAA,uKAAI,EAAC,MAAM,UAAU;IACzB,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO;IAC1B,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO,GAAG,MAAM;IACrC,eAAe,IAAA,6KAAO,EAAC;IACvB,OAAO,IAAA,uKAAI,EAAC;IACZ,UAAU,IAAA,uKAAI,EAAC;IACf,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,UAAU,IAAA,gKAAO,EAAC,YAAY;IACzC,IAAI,IAAA,uKAAI,EAAC,MAAM,UAAU;IACzB,WAAW,IAAA,iLAAS,EAAC,cAAc,OAAO;IAC1C,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO,GAAG,MAAM;IACrC,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,uKAAI,EAAC;IAChB,WAAW,IAAA,uKAAI,EAAC;IAChB,QAAQ,IAAA,uKAAI,EAAC,WAAW,OAAO,GAAG,UAAU,CAAC,IAAM,KAAK,EAAE,EAAE;QAAE,UAAU;IAAU;AACpF;AAEO,MAAM,UAAU,IAAA,gKAAO,EAAC,YAAY;IACzC,IAAI,IAAA,uKAAI,EAAC,MAAM,UAAU;IACzB,QAAQ,IAAA,uKAAI,EAAC,WAAW,OAAO,GAAG,UAAU,CAAC,IAAM,KAAK,EAAE,EAAE;QAAE,UAAU;IAAU;IAClF,WAAW,IAAA,uKAAI,EAAC,cAAc,OAAO;IACrC,YAAY,IAAA,uKAAI,EAAC,eAAe,OAAO;IACvC,aAAa,IAAA,uKAAI,EAAC;IAClB,cAAc,IAAA,uKAAI,EAAC;IACnB,sBAAsB,IAAA,iLAAS,EAAC;IAChC,uBAAuB,IAAA,iLAAS,EAAC;IACjC,OAAO,IAAA,uKAAI,EAAC;IACZ,SAAS,IAAA,uKAAI,EAAC;IACd,UAAU,IAAA,uKAAI,EAAC;IACf,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AACzD;AAEO,MAAM,eAAe,IAAA,gKAAO,EAAC,iBAAiB;IACnD,IAAI,IAAA,uKAAI,EAAC,MAAM,UAAU;IACzB,YAAY,IAAA,uKAAI,EAAC,cAAc,OAAO;IACtC,OAAO,IAAA,uKAAI,EAAC,SAAS,OAAO;IAC5B,WAAW,IAAA,iLAAS,EAAC,cAAc,OAAO;IAC1C,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;IACvD,WAAW,IAAA,iLAAS,EAAC,cAAc,OAAO;AAC5C","debugId":null}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///Users/phuonghuupham/Documents/GitHub/Pathfinity/src/db/index.ts"],"sourcesContent":["import { neon } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-http';\n\nimport * as schema from './schema';\n\nconst sql = neon(process.env.DATABASE_URL as string);\nexport const db = drizzle(sql, { schema });"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;;;;AAEA,MAAM,MAAM,IAAA,8JAAI,EAAC,QAAQ,GAAG,CAAC,YAAY;AAClC,MAAM,KAAK,IAAA,mKAAO,EAAC,KAAK;IAAE,QAAA;AAAO","debugId":null}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///Users/phuonghuupham/Documents/GitHub/Pathfinity/lib/auth.ts"],"sourcesContent":["import { betterAuth } from \"better-auth\";\nimport { drizzleAdapter } from \"better-auth/adapters/drizzle\";\nimport { db } from \"@/src/db\";\nimport * as schema from \"@/src/db/schema\";\nimport crypto from \"crypto\";\nimport { eq } from \"drizzle-orm\";\n\n// Function to generate a secure random password\nfunction generateSecurePassword(length: number = 16): string {\n  const charset = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*\";\n  let password = \"\";\n  for (let i = 0; i < length; i++) {\n    password += charset.charAt(crypto.randomInt(0, charset.length));\n  }\n  return password;\n}\n\nexport const auth = betterAuth({\n  database: drizzleAdapter(db, {\n    provider: \"pg\",\n    schema: {\n      user: schema.user,\n      session: schema.session,\n      account: schema.account,\n      verification: schema.verification,\n    },\n  }),\n  secret: process.env.BETTER_AUTH_SECRET || \"fallback-secret-for-development\",\n  pages : {\n    signIn: '/login',\n  },\n  emailAndPassword: {\n    enabled: true,\n    requireEmailVerification: false,\n  },\n  socialProviders: {\n        github: { \n            clientId: process.env.GITHUB_CLIENT_ID as string, \n            clientSecret: process.env.GITHUB_CLIENT_SECRET as string, \n        }, \n        google: { \n            clientId: process.env.GOOGLE_CLIENT_ID as string, \n            clientSecret: process.env.GOOGLE_CLIENT_SECRET as string, \n        },\n    },\n  events: {\n    user: {\n      created: async (user: { id: string; email: string; password?: string }) => {\n        // Only run for OAuth users (no password) and when email exists\n        if (!user.password && user.email) {\n          try {\n            // Check if another user with this email already exists\n            const existingUser = await db.query.user.findFirst({\n              where: eq(schema.user.email, user.email),\n              columns: { id: true, email: true, password: true, name: true, image: true, emailVerified: true }\n            });\n\n            // If we found another user with the same email (not the one just created)\n            if (existingUser && existingUser.id !== user.id) {\n              console.log(`Found existing user with email ${user.email}. Linking accounts...`);\n              \n              // Move the account from the new user to the existing user\n              await db.update(schema.account)\n                .set({ userId: existingUser.id })\n                .where(eq(schema.account.userId, user.id));\n\n              // Move any sessions from the new user to the existing user\n              await db.update(schema.session)\n                .set({ userId: existingUser.id })\n                .where(eq(schema.session.userId, user.id));\n\n              // Update existing user with OAuth info if missing\n              const updateData: Partial<typeof schema.user.$inferInsert> = {};\n              if (!existingUser.image && user.id) {\n                // Get the new user's image from the database\n                const newUserData = await db.query.user.findFirst({\n                  where: eq(schema.user.id, user.id),\n                  columns: { image: true }\n                });\n                if (newUserData?.image) {\n                  updateData.image = newUserData.image;\n                }\n              }\n              if (!existingUser.emailVerified) {\n                updateData.emailVerified = true;\n              }\n              \n              if (Object.keys(updateData).length > 0) {\n                await db.update(schema.user)\n                  .set(updateData)\n                  .where(eq(schema.user.id, existingUser.id));\n              }\n\n              // If existing user doesn't have a password, generate one\n              if (!existingUser.password) {\n                const randomPassword = generateSecurePassword();\n                const bcrypt = await import('bcryptjs');\n                const hashedPassword = await bcrypt.hash(randomPassword, 12);\n                \n                await db.update(schema.user)\n                  .set({ password: hashedPassword })\n                  .where(eq(schema.user.id, existingUser.id));\n              }\n\n              // Delete the duplicate user that was just created\n              await db.delete(schema.user)\n                .where(eq(schema.user.id, user.id));\n\n              console.log(`Successfully linked OAuth account to existing user: ${existingUser.email}`);\n              return; // Exit early since we've handled the linking\n            }\n\n            // If no existing user found, this is a new OAuth user - generate password\n            const randomPassword = generateSecurePassword();\n            const bcrypt = await import('bcryptjs');\n            const hashedPassword = await bcrypt.hash(randomPassword, 12);\n            \n            await db.update(schema.user)\n              .set({ password: hashedPassword })\n              .where(eq(schema.user.id, user.id));\n            \n            console.log(`Generated password for new OAuth user: ${user.email}`);\n          } catch (error) {\n            console.error(\"Error handling OAuth user creation:\", error);\n          }\n        }\n      },\n    },\n  },\n});\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 245, "column": 0}, "map": {"version":3,"sources":["file:///Users/phuonghuupham/Documents/GitHub/Pathfinity/lib/auth-server.ts"],"sourcesContent":["import { headers } from \"next/headers\";\nimport { auth } from \"./auth\";\n\nexport const getSession = async () => {\n  return auth.api.getSession({\n    headers: await headers()\n  });\n};"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,MAAM,aAAa;IACxB,OAAO,mHAAI,CAAC,GAAG,CAAC,UAAU,CAAC;QACzB,SAAS,MAAM,IAAA,0IAAO;IACxB;AACF","debugId":null}},
    {"offset": {"line": 262, "column": 0}, "map": {"version":3,"sources":["file:///Users/phuonghuupham/Documents/GitHub/Pathfinity/app/page.tsx"],"sourcesContent":["import { redirect } from 'next/navigation';\nimport { getSession } from '@/lib/auth-server';\nimport Link from 'next/link';\n\nexport default async function Home() {\n  const session = await getSession();\n\n  // If the user is authenticated, send them to the dashboard (which lives\n  // under the `(with-sidebar)` route group so it includes the sidebar).\n  if (session) {\n    redirect('/Home');\n  }\n\n  // Otherwise render the public landing page\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-background to-[#f8fafc]\">\n      <header className=\"flex items-center justify-between px-8 py-6 max-w-7xl mx-auto w-full\">\n        <Link href=\"/\" className=\"flex items-center gap-3\">\n          <div className=\"h-10 w-10 rounded-md bg-indigo-600 flex items-center justify-center text-white font-bold\">\n            P\n          </div>\n          <span className=\"text-xl font-semibold\">Pathfinity</span>\n        </Link>\n\n        <nav className=\"flex items-center gap-3\">\n          <Link href=\"/login\" className=\"text-sm font-medium text-muted-foreground hover:text-gray-900\">\n            Log in\n          </Link>\n          <Link href=\"/login\" className=\"ml-2 inline-flex items-center px-4 py-2 rounded-md bg-indigo-600 text-white text-sm font-semibold hover:bg-indigo-700\">\n            Sign up\n          </Link>\n        </nav>\n      </header>\n\n      <main className=\"flex-1 flex items-center justify-center px-6\">\n        <section className=\"max-w-4xl text-center py-20\">\n          <h1 className=\"text-4xl sm:text-5xl font-extrabold mb-6\">Bring student journeys to life with Pathfinity</h1>\n          <p className=\"text-lg text-muted-foreground mb-8\">\n            Pathfinity helps institutions map programs, people, and career pathways so students\n            can discover meaningful majors, internships, and careers. Connect learners with\n            resources, mentors, and real-world outcomes â€” all in one place.\n          </p>\n\n          <div className=\"flex justify-center gap-4\">\n            <Link href=\"/login\" className=\"inline-flex items-center px-6 py-3 rounded-md bg-indigo-600 text-white font-semibold hover:bg-indigo-700\">\n              Get started\n            </Link>\n            <Link href=\"/\" className=\"inline-flex items-center px-6 py-3 rounded-md border border-gray-200 text-sm font-medium text-gray-700 hover:bg-gray-50\">\n              Learn more\n            </Link>\n          </div>\n        </section>\n      </main>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AACA;AACA;;;;;AAEe,eAAe;IAC5B,MAAM,UAAU,MAAM,IAAA,mIAAU;IAEhC,wEAAwE;IACxE,sEAAsE;IACtE,IAAI,SAAS;QACX,IAAA,iMAAQ,EAAC;IACX;IAEA,2CAA2C;IAC3C,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAO,WAAU;;kCAChB,8OAAC,0LAAI;wBAAC,MAAK;wBAAI,WAAU;;0CACvB,8OAAC;gCAAI,WAAU;0CAA2F;;;;;;0CAG1G,8OAAC;gCAAK,WAAU;0CAAwB;;;;;;;;;;;;kCAG1C,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,0LAAI;gCAAC,MAAK;gCAAS,WAAU;0CAAgE;;;;;;0CAG9F,8OAAC,0LAAI;gCAAC,MAAK;gCAAS,WAAU;0CAAwH;;;;;;;;;;;;;;;;;;0BAM1J,8OAAC;gBAAK,WAAU;0BACd,cAAA,8OAAC;oBAAQ,WAAU;;sCACjB,8OAAC;4BAAG,WAAU;sCAA2C;;;;;;sCACzD,8OAAC;4BAAE,WAAU;sCAAqC;;;;;;sCAMlD,8OAAC;4BAAI,WAAU;;8CACb,8OAAC,0LAAI;oCAAC,MAAK;oCAAS,WAAU;8CAA2G;;;;;;8CAGzI,8OAAC,0LAAI;oCAAC,MAAK;oCAAI,WAAU;8CAA0H;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ/J","debugId":null}}]
}